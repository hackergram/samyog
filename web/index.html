<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="http://twitter.github.com/typeahead.js/releases/latest/typeahead.bundle.js"></script>
<script src="http://twitter.github.com/typeahead.js/releases/latest/typeahead.jquery.js"></script>
<script src="http://twitter.github.com/typeahead.js/releases/latest/bloodhound.js"></script>

</head>



<div id="prefetch">
  <input class="typeahead" type="text" placeholder="Countries">
</div>


<script>

  var countries = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    remote: {
      url: "http://192.168.56.101:5010/collections",
      filter: function(response) {
        return response.resp;
      }
    }
  });

  // initialize the bloodhound suggestion engine
  countries.initialize();

  function autocompleteDevices(q, sync, async) {
    console.log(q,countries)
      if (q === '') {
          async(countries.all());
      } else {
          countries.search(q, async);
      }
  }

  // instantiate the typeahead UI
  $('.typeahead').typeahead(
    { hint: true,
      highlight: true,
      minLength: 1
    },
    {
    name: 'countries',
    displayKey: function(countries) {
      console.log(countries)
      return countries.collection_name;
    },
    source: autocompleteDevices,
    templates: {
      notFound: '<div>Not Found</div>',   /* Rendered if 0 suggestions are available */
      pending: '<div>Loading...</div>',   /* Rendered if 0 synchronous suggestions available
                                           but asynchronous suggestions are expected */
      suggestion:  function(data) {       /* Used to render a single suggestion */
                    return '<div>'+ data.collection_name +'</div>'
                 },

    }
  });




</script>
